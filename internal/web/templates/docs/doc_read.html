{{define "doc_read.html"}}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Title}}</title>
    <link rel="stylesheet" href="/static/css/main.css">
    <script src="https://unpkg.com/htmx.org@1.9.10" defer></script>
</head>
<body>
    <div class="app-container">
        {{template "sidebar" .}}
        <main class="main-content">
            {{template "topbar" .}}
            <div class="content">
                {{if .Error}}<div class="alert alert-error">{{.Error}}</div>{{end}}
                {{if .Success}}<div class="alert alert-success">{{.Success}}</div>{{end}}

                <div class="doc-container">
                    <div class="doc-main">
                        <div class="page-header">
                            <div class="page-header-row">
                                <h2>{{.Document.Title}}</h2>
                                <div class="doc-actions">
                                    {{if $.Membership.IsEditor}}
                                    <a href="/docs/id/{{.Document.ID}}/edit" class="btn btn-primary">Edit</a>
                                    {{end}}
                                    <a href="/docs/id/{{.Document.ID}}/history" class="btn btn-secondary">History</a>
                                </div>
                            </div>
                            <div class="doc-meta">
                                <span class="doc-path"><code>{{.Document.Path}}</code></span>
                                {{if eq .Document.DocType "runbook"}}
                                <span class="badge badge-warning">Runbook</span>
                                {{end}}
                                {{if .Document.Client}}
                                <span class="doc-client">Client: <a href="/clients/{{.Document.Client.ID}}">{{.Document.Client.Name}}</a></span>
                                {{end}}
                            </div>
                        </div>

                        <div class="card doc-content">
                            <div class="markdown-body">
                                {{.RenderedBody}}
                            </div>
                        </div>
                    </div>

                    <aside class="doc-sidebar">
                        <div class="card">
                            <h4>Document Info</h4>
                            <dl class="meta-list">
                                <dt>Created</dt>
                                <dd>{{.Document.CreatedAt.Format "Jan 2, 2006"}}</dd>
                                <dt>Updated</dt>
                                <dd>{{.Document.UpdatedAt.Format "Jan 2, 2006 3:04 PM"}}</dd>
                                {{if .Document.Owner}}
                                <dt>Owner</dt>
                                <dd>{{.Document.Owner.Name}}</dd>
                                {{end}}
                                {{if .Document.CurrentRevision}}
                                {{if .Document.CurrentRevision.Author}}
                                <dt>Last edited by</dt>
                                <dd>{{.Document.CurrentRevision.Author.Name}}</dd>
                                {{end}}
                                {{end}}
                            </dl>
                        </div>
                    </aside>
                </div>

            </div>
        </main>
    </div>
</body>
</html>
{{end}}
